<!-- Login Container with Modern Gradient Background -->
<div
  class="relative flex min-h-screen items-center justify-center overflow-hidden"
>
  <!-- Toast Component for Notifications -->
  <p-toast position="top-right"></p-toast>
  <!-- Live region for screen readers - Critical announcements only -->
  <div aria-live="polite" aria-atomic="true" class="sr-only">
    <span *ngIf="isLoading()">Signing in, please wait...</span>
    <span *ngIf="isAccountLocked()"
      >Account temporarily locked due to failed attempts. Please try again in {{
      (remainingLockoutTime() / 60000) | number:'1.0-0' }} minutes.</span
    >
  </div>

  <!-- Animated Gradient Background -->
  <div
    class="absolute inset-0"
    style="
      background: linear-gradient(
        135deg,
        #4c1d95 0%,
        #312e81 50%,
        #1e1b4b 100%
      );
    "
  ></div>

  <!-- Animated Background Elements -->
  <div class="absolute inset-0 overflow-hidden">
    <!-- Floating Orbs -->
    <div
      class="absolute top-20 left-20 h-64 w-64 animate-pulse rounded-full bg-purple-600/20 blur-xl"
    ></div>
    <div
      class="absolute right-20 bottom-20 h-80 w-80 animate-pulse rounded-full bg-indigo-600/15 blur-xl delay-1000"
    ></div>
    <div
      class="absolute top-1/2 left-1/2 h-96 w-96 -translate-x-1/2 -translate-y-1/2 transform animate-pulse rounded-full bg-violet-600/10 blur-2xl delay-500"
    ></div>

    <!-- Subtle Sports Academy Background Elements -->
    <div class="pointer-events-none absolute inset-0 overflow-hidden">
      <!-- Soccer Ball Silhouette - Top Left Corner -->
      <div
        class="absolute h-20 w-20 animate-pulse opacity-5 delay-1000"
        style="top: 8%; left: 8%; transform: rotate(-15deg)"
      >
        <svg viewBox="0 0 100 100" class="h-full w-full text-white">
          <circle cx="50" cy="50" r="45" fill="currentColor" />
          <path
            d="M50 5 L65 35 L95 35 L75 55 L85 85 L50 70 L15 85 L25 55 L5 35 L35 35 Z"
            fill="#312e81"
            fill-opacity="0.3"
          />
          <circle cx="50" cy="50" r="8" fill="#312e81" fill-opacity="0.4" />
        </svg>
      </div>

      <!-- Basketball Silhouette - Top Right Corner -->
      <div
        class="absolute h-16 w-16 animate-pulse opacity-5 delay-2000"
        style="top: 12%; right: 10%; transform: rotate(25deg)"
      >
        <svg viewBox="0 0 100 100" class="h-full w-full text-white">
          <circle cx="50" cy="50" r="45" fill="currentColor" />
          <path
            d="M5 50 Q50 20, 95 50"
            stroke="#312e81"
            stroke-width="3"
            fill="none"
            opacity="0.4"
          />
          <path
            d="M5 50 Q50 80, 95 50"
            stroke="#312e81"
            stroke-width="3"
            fill="none"
            opacity="0.4"
          />
          <path
            d="M50 5 Q20 50, 50 95"
            stroke="#312e81"
            stroke-width="3"
            fill="none"
            opacity="0.4"
          />
          <path
            d="M50 5 Q80 50, 50 95"
            stroke="#312e81"
            stroke-width="3"
            fill="none"
            opacity="0.4"
          />
        </svg>
      </div>

      <!-- Tennis Racket Silhouette - Bottom Left Corner -->
      <div
        class="absolute h-24 w-12 animate-pulse opacity-5 delay-3000"
        style="bottom: 15%; left: 12%; transform: rotate(-35deg)"
      >
        <svg viewBox="0 0 50 100" class="h-full w-full text-white">
          <ellipse
            cx="25"
            cy="25"
            rx="18"
            ry="22"
            fill="none"
            stroke="currentColor"
            stroke-width="4"
          />
          <rect x="22" y="47" width="6" height="45" fill="currentColor" />
          <path
            d="M10 15 L40 15 M10 25 L40 25 M10 35 L40 35"
            stroke="#312e81"
            stroke-width="1"
            opacity="0.4"
          />
          <path
            d="M15 8 L15 42 M25 8 L25 42 M35 8 L35 42"
            stroke="#312e81"
            stroke-width="1"
            opacity="0.4"
          />
        </svg>
      </div>

      <!-- Trophy Silhouette - Bottom Right Corner -->
      <div
        class="absolute h-18 w-14 animate-pulse opacity-5 delay-4000"
        style="bottom: 10%; right: 8%; transform: rotate(18deg)"
      >
        <svg viewBox="0 0 100 120" class="h-full w-full text-white">
          <path
            d="M30 20 L70 20 L75 50 L65 70 L35 70 L25 50 Z"
            fill="currentColor"
          />
          <rect x="45" y="70" width="10" height="25" fill="currentColor" />
          <rect x="35" y="95" width="30" height="8" fill="currentColor" />
          <ellipse cx="20" cy="35" rx="8" ry="12" fill="currentColor" />
          <ellipse cx="80" cy="35" rx="8" ry="12" fill="currentColor" />
          <circle cx="50" cy="35" r="6" fill="#312e81" fill-opacity="0.4" />
        </svg>
      </div>

      <!-- Whistle Silhouette - Left Side -->
      <div
        class="absolute h-6 w-10 animate-pulse opacity-5 delay-5000"
        style="top: 35%; left: 5%; transform: rotate(55deg)"
      >
        <svg viewBox="0 0 100 40" class="h-full w-full text-white">
          <ellipse cx="30" cy="20" rx="25" ry="15" fill="currentColor" />
          <rect x="55" y="17" width="40" height="6" fill="currentColor" />
          <circle cx="30" cy="20" r="4" fill="#312e81" fill-opacity="0.4" />
        </svg>
      </div>

      <!-- Volleyball Silhouette - Right Side -->
      <div
        class="absolute h-14 w-14 animate-pulse opacity-5 delay-1500"
        style="top: 60%; right: 6%; transform: rotate(-8deg)"
      >
        <svg viewBox="0 0 100 100" class="h-full w-full text-white">
          <circle cx="50" cy="50" r="45" fill="currentColor" />
          <path
            d="M5 30 Q50 10, 95 30"
            stroke="#312e81"
            stroke-width="2"
            fill="none"
            opacity="0.4"
          />
          <path
            d="M5 50 Q50 30, 95 50"
            stroke="#312e81"
            stroke-width="2"
            fill="none"
            opacity="0.4"
          />
          <path
            d="M5 70 Q50 50, 95 70"
            stroke="#312e81"
            stroke-width="2"
            fill="none"
            opacity="0.4"
          />
        </svg>
      </div>

      <!-- Badminton Shuttlecock - Top Center Edge -->
      <div
        class="absolute h-16 w-8 animate-pulse opacity-5 delay-3500"
        style="top: 5%; left: 48%; transform: rotate(-25deg)"
      >
        <svg viewBox="0 0 40 80" class="h-full w-full text-white">
          <ellipse cx="20" cy="65" rx="12" ry="8" fill="currentColor" />
          <path d="M8 65 L20 15 L32 65" fill="currentColor" opacity="0.8" />
          <path
            d="M10 65 L20 25 L30 65"
            stroke="#312e81"
            stroke-width="1"
            fill="none"
            opacity="0.4"
          />
        </svg>
      </div>
    </div>

    <!-- Grid Pattern Overlay -->
    <div
      class="absolute inset-0 bg-gradient-to-br from-transparent via-white to-transparent opacity-20"
    ></div>
  </div>

  <!-- Login Card -->
  <div class="relative z-10 mx-4 w-full max-w-md space-y-8">
    <!-- Glass Card Effect -->
    <div
      class="rounded-2xl border border-gray-200 bg-white p-8 shadow-2xl ring-1 ring-gray-100"
    >
      <!-- Header Section -->
      <div class="text-center">
        <!-- Logo with Glow Effect -->
        <div class="mb-6 flex justify-center">
          <div
            class="flex h-16 w-16 items-center justify-center rounded-xl bg-gradient-to-br from-purple-700 to-indigo-800 shadow-lg shadow-purple-500/25"
            style="
              background: linear-gradient(135deg, #4c1d95 0%, #1e1b4b 100%);
            "
          >
            <i class="pi pi-trophy text-2xl text-white"></i>
          </div>
        </div>

        <!-- App Title -->
        <h1
          class="mb-2 bg-gradient-to-r from-purple-700 to-indigo-800 bg-clip-text text-3xl font-bold text-transparent"
          style="
            background: linear-gradient(135deg, #4c1d95 0%, #1e1b4b 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
          "
        >
          NXAcademy
        </h1>

        <p class="mb-6 text-sm font-medium text-gray-600">
          One Platform | Every Sport | Every Athlete
        </p>

        <!-- Welcome Message -->
        <h2 id="login-heading" class="mb-2 text-xl font-semibold text-gray-800">
          Welcome Back
        </h2>
        <p class="text-sm text-gray-600">Sign in to continue your journey</p>
      </div>

      <!-- Account Lockout Warning -->
      <div
        *ngIf="isAccountLocked()"
        class="mb-6 rounded-lg border border-red-200 bg-red-50 p-4"
        role="alert"
        aria-live="polite"
      >
        <div class="flex items-center">
          <i class="pi pi-exclamation-triangle mr-2 text-red-600"></i>
          <div>
            <h3 class="text-sm font-medium text-red-800">
              Account Temporarily Locked
            </h3>
            <p class="mt-1 text-sm text-red-700">
              Too many failed login attempts. Please try again in {{
              (remainingLockoutTime() / 60000) | number:'1.0-0' }} minutes.
            </p>
          </div>
        </div>
      </div>
      <!-- Login Form -->
      <form
        class="login-form mt-8 space-y-6"
        [formGroup]="loginForm"
        (ngSubmit)="onLogin()"
        novalidate
        aria-labelledby="login-heading"
        role="form"
        (keydown.enter)="onLogin()"
      >
        <!-- Skip to main content link for keyboard users -->
        <a
          class="sr-only z-50 rounded bg-white px-4 py-2 shadow-lg focus:not-sr-only focus:absolute focus:top-2 focus:left-2"
          href="#username"
        >
          Skip to username field
        </a>
        <!-- Anti-autofill honeypot fields -->
        <div style="position: absolute; left: -9999px; opacity: 0">
          <input
            type="text"
            name="fake-username"
            tabindex="-1"
            autocomplete="off"
          />
          <input
            type="password"
            name="fake-password"
            tabindex="-1"
            autocomplete="off"
          />
        </div>

        <!-- Username Field -->
        <div>
          <label
            for="username"
            class="mb-2 block text-sm font-medium text-gray-700"
          >
            Username <span class="text-red-500">*</span>
          </label>
          <div class="relative">
            <div
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"
            >
              <i class="pi pi-user text-gray-400"></i>
            </div>
            <input
              id="username"
              type="text"
              formControlName="username"
              readonly
              onfocus="this.removeAttribute('readonly');"
              class="block w-full rounded-lg border border-gray-300 bg-gray-50 py-3 pr-10 pl-10 text-gray-900 placeholder-gray-500 transition-all duration-200 focus:border-purple-500 focus:bg-white focus:shadow-[0_0_0_2px_theme(colors.purple.100)] focus:ring-4 focus:ring-purple-200 focus:outline-none"
              [class.border-red-300]="usernameErrors() && (loginForm.get('username')?.touched || formSubmitted())"
              [class.bg-red-50]="usernameErrors() && (loginForm.get('username')?.touched || formSubmitted())"
              [class.border-green-300]="isUsernameValid()"
              [class.bg-green-50]="isUsernameValid()"
              placeholder="Enter your username"
              (focus)="onUsernameFocus()"
              (blur)="onUsernameBlur()"
              required
              autocomplete="new-password"
              spellcheck="false"
              aria-describedby="username-error username-help"
              [attr.aria-invalid]="usernameErrors() && (loginForm.get('username')?.touched || formSubmitted())"
            />
            <div class="absolute inset-y-0 right-0 flex items-center pr-3">
              <i
                *ngIf="(loginForm.get('username')?.touched || formSubmitted()) && (usernameErrors() || isUsernameValid())"
                class="pi text-sm transition-all duration-300"
                [class.pi-check-circle]="isUsernameValid()"
                [class.text-green-500]="isUsernameValid()"
                [class.animate-bounce]="isUsernameValid()"
                [class.pi-times-circle]="usernameErrors()"
                [class.text-red-500]="usernameErrors()"
                [class.animate-pulse]="usernameErrors() && (loginForm.get('username')?.touched || formSubmitted())"
              ></i>
            </div>
          </div>
          <div
            *ngIf="usernameErrors() && (loginForm.get('username')?.touched || formSubmitted())"
            class="mt-2 flex items-center text-sm text-red-600"
          >
            <i class="pi pi-exclamation-triangle mr-1"></i>
            {{ usernameErrors()?.['message'] || 'Invalid username' }}
          </div>
        </div>
        <!-- Password Field -->
        <div>
          <label
            for="password"
            class="mb-2 block text-sm font-medium text-gray-700"
          >
            Password <span class="text-red-500">*</span>
          </label>
          <div class="relative">
            <div
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"
            >
              <i class="pi pi-lock text-gray-400"></i>
            </div>
            <input
              id="password"
              [type]="showPassword() ? 'text' : 'password'"
              formControlName="password"
              readonly
              onfocus="this.removeAttribute('readonly');"
              class="block w-full rounded-lg border border-gray-300 bg-gray-50 py-3 pr-20 pl-10 text-gray-900 placeholder-gray-500 transition-all duration-200 focus:border-purple-500 focus:bg-white focus:shadow-[0_0_0_2px_theme(colors.purple.100)] focus:ring-4 focus:ring-purple-200 focus:outline-none"
              [class.border-red-300]="passwordErrors() && (loginForm.get('password')?.touched || formSubmitted())"
              [class.bg-red-50]="passwordErrors() && (loginForm.get('password')?.touched || formSubmitted())"
              [class.border-green-300]="isPasswordValid()"
              [class.bg-green-50]="isPasswordValid()"
              placeholder="Enter your password"
              (focus)="onPasswordFocus()"
              (blur)="onPasswordBlur()"
              required
              autocomplete="new-password"
              spellcheck="false"
            />
            <div class="absolute inset-y-0 right-0 flex items-center">
              <button
                type="button"
                class="cursor-pointer rounded px-3 py-2 text-gray-400 transition-colors duration-200 hover:text-gray-600 focus:ring-2 focus:ring-purple-500 focus:ring-offset-1 focus:outline-none"
                (click)="togglePasswordVisibility()"
                [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'"
                [attr.aria-pressed]="showPassword()"
                tabindex="0"
                (keydown.enter)="togglePasswordVisibility()"
                (keydown.space)="$event.preventDefault(); togglePasswordVisibility()"
              >
                <i
                  class="pi"
                  [class.pi-eye]="!showPassword()"
                  [class.pi-eye-slash]="showPassword()"
                  [attr.aria-hidden]="true"
                ></i>
              </button>
              <div class="pr-3">
                <i
                  *ngIf="(loginForm.get('password')?.touched || formSubmitted()) && (passwordErrors() || isPasswordValid())"
                  class="pi text-sm transition-all duration-300"
                  [class.pi-check-circle]="isPasswordValid()"
                  [class.text-green-500]="isPasswordValid()"
                  [class.animate-bounce]="isPasswordValid()"
                  [class.pi-times-circle]="passwordErrors()"
                  [class.text-red-500]="passwordErrors()"
                  [class.animate-pulse]="passwordErrors() && (loginForm.get('password')?.touched || formSubmitted())"
                ></i>
              </div>
            </div>
          </div>
          <div
            *ngIf="passwordErrors() && (loginForm.get('password')?.touched || formSubmitted())"
            class="mt-2 flex items-center text-sm text-red-600"
          >
            <i class="pi pi-exclamation-triangle mr-1"></i>
            {{ passwordErrors()?.['message'] || 'Invalid password' }}
          </div>
        </div>
        <!-- Remember Me & Forgot Password -->
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <input
              id="rememberMe"
              type="checkbox"
              formControlName="rememberMe"
              class="h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"
            />
            <label
              for="rememberMe"
              class="ml-2 block cursor-pointer text-sm text-gray-600"
            >
              Remember me
            </label>
          </div>
          <button
            type="button"
            class="cursor-pointer text-sm font-medium text-purple-600 transition-all duration-200 hover:text-purple-700 focus:outline-none"
            (click)="onForgotPassword()"
          >
            Forgot Password?
          </button>
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          [disabled]="isLoading()"
          class="flex w-full cursor-pointer items-center justify-center rounded-lg bg-gradient-to-r from-purple-700 to-indigo-800 px-4 py-3 font-semibold text-white shadow-lg shadow-purple-500/25 transition-all duration-200 hover:from-purple-800 hover:to-indigo-900 focus:shadow-[0_0_0_2px_theme(colors.purple.100)] focus:ring-4 focus:ring-purple-200 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50"
          style="background: linear-gradient(135deg, #4c1d95 0%, #1e1b4b 100%)"
        >
          <span *ngIf="!isLoading()" class="flex items-center">
            <i class="pi pi-sign-in mr-2"></i>
            Sign In
          </span>
          <span *ngIf="isLoading()" class="flex items-center">
            <svg
              class="mr-3 -ml-1 h-5 w-5 animate-spin text-white"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              ></path>
            </svg>
            Signing in...
          </span>
        </button>
      </form>
      <!-- Support Link -->
      <div class="mt-6 text-center">
        <p class="text-sm text-gray-600">
          Need help?
          <button
            type="button"
            class="ml-1 cursor-pointer text-sm font-medium text-purple-600 transition-all duration-200 hover:text-purple-700 focus:outline-none"
            (click)="onContactSupport()"
          >
            Contact Support
          </button>
        </p>
      </div>
    </div>
  </div>
</div>
